<div class="cardBackground">
  <div class="FactGridTitle" [class.with-researchfield-input]="showResearchField">
    FactGrid
  </div>  
  <div class="subTitle">{{subtitle}}</div>
  <div *ngIf="selectedResearchField$ | async as selected">
    <div class="selected-research-field">
      <ng-container *ngIf="selected.name !== 'all'">
        {{ selected.name }}
      </ng-container>
    </div>
  </div>


</div>

<div class="search-center2">
  <div class="search-inputs-row">
    <!-- Colonne projet -->
    <!---   <div class="search-field-col">
         <mat-form-field appearance="outline" class="search-field">
           <mat-label>{{projectsInput}}</mat-label>
           <input type="text"
                  matInput
                  class="search-input-style"
                  [formControl]="searchResearchField"
                  [matAutocomplete]="auto"
                  placeholder="Nom du projet">
           <button mat-icon-button
                   matSuffix
                   *ngIf="searchResearchField.value"
                   aria-label="Effacer"
                   (click)="clearProjectSearch()">
             <mat-icon>close</mat-icon>
           </button>
           <mat-autocomplete #auto="matAutocomplete"
                             [displayWith]="displayResearchField.bind(this)"
                             (optionSelected)="researchFieldSelect($event.option.value)">
             @for (researchField of filteredResearchFields$ | async; track researchField) {
             <mat-option [value]="researchField">
               <span class="autocomplete-option-content">{{ researchField.name }}</span>
               @if (researchField.id === selectedResearchField) {
               <mat-icon color="primary" style="margin-left:8px;">check_circle</mat-icon>
               }
             </mat-option>
             }
           </mat-autocomplete>
         </mat-form-field>
       </div> --->
    <!-- Colonne items -->
    <div class="search-field-col">
      <mat-form-field appearance="outline" class="search-field">
        <mat-label>{{itemsInput}}</mat-label>
        <input matInput
               class="search-input-style"
               placeholder="ex: Goethe"
               [formControl]="searchInput">
        <button mat-icon-button
                matSuffix
                *ngIf="searchInput.value"
                aria-label="Effacer"
                (click)="clearItemSearch()">
          <mat-icon>close</mat-icon>
        </button>
        <mat-hint align="end">{{ hintValue$ | async }} items</mat-hint>
      </mat-form-field>
    </div>
  </div>
</div>

<!-- Affichage de la liste des items trouvés -->
@let results = (searchResults$ | async);
@if (results && results.length > 0) {
<div class="items-list-container">
  <div class="items-list-inner">
    @if (results.length > 20) {
    <mat-form-field appearance="outline" class="filter-field">
      <mat-label>{{filterResults}}</mat-label>
      <input matInput [formControl]="filterInput" placeholder="Filtrer par nom ou description">
    </mat-form-field>
    }
    <ul>
      @for (item of filteredItems$ | async; track item.id) {
      <li class="item-row">
        <div class="item-main">
          <span class="search-label">
            {{ item.label }}<span *ngIf="item.description">,&nbsp;</span>
          </span>
          @if (item.description) {
          <span class="item-description">{{ item.description }}</span>
          }
        </div>
        <span class="item-actions" style="margin-left:auto;">
          <button mat-icon-button class="internalLink" [routerLink]="['/item', item.id]" aria-label="Voir l'item">
            <mat-icon color="primary" [inline]="true">open_in_new</mat-icon>
          </button>
        </span>
      </li>
      }
    </ul>
  </div>
</div>
}
@let filtered = (filteredItems$ | async);
@let searchValue = (searchInputValue$ | async);
@if (isArray(filtered) && filtered.length === 0 && searchValue) {
<p class="no-results">Aucun résultat trouvé.</p>
}


