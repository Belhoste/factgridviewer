import{a as ce}from"./chunk-YZ3JZAUA.js";import{l as re}from"./chunk-JP26QXSL.js";import{$b as N,A as I,Aa as D,Ad as ae,Ba as A,Bd as oe,Ca as w,Cd as se,D as M,Da as p,Ea as a,Ed as le,Fa as r,G as F,Ga as u,Jb as V,K as d,Ka as k,Lb as q,Ma as O,N as P,Na as h,O as L,Pb as U,Sb as z,Ub as G,Uc as K,Vc as X,Ya as l,Za as R,_a as C,ac as Q,da as T,ea as s,h as y,j as _,lb as B,mb as j,na as E,nc as H,o as f,oc as J,od as Y,pc as W,td as Z,u as S,ud as ee,v as b,wb as $,xd as te,ya as g,yd as ie,za as v,zd as ne}from"./chunk-DHSVE5L6.js";var de=(()=>{let i=class i{constructor(){this.seed=["jaw","jar","toy","troy","hip","hop"],this.data$=new _(this.seed),this.data=this.data$.asObservable()}addData(e){let n=this.data$.getValue().concat(e);this.data$.next(n)}};i.\u0275fac=function(n){return new(n||i)},i.\u0275prov=F({token:i,factory:i.\u0275fac,providedIn:"root"});let t=i;return t})();var pe=()=>[""],ue=t=>["/item",t];function he(t,i){return this.trackById(i)}function fe(t,i){if(t&1&&(a(0,"span"),l(1),r()),t&2){let o=h().$implicit;s(),C(", ",o.description)}}function ge(t,i){if(t&1){let o=k();a(0,"div")(1,"span",9),l(2),r(),a(3,"mat-icon-button",10),O("click",function(){let n=P(o).$implicit,c=h(2);return L(c.openItem(n))}),a(4,"mat-icon",11),l(5,"open_in_new"),r()(),l(6," \xA0\xA0\xA0 "),g(7,fe,2,1,"span"),u(8,"hr"),r()}if(t&2){let o=i.$implicit;s(2),C("",o.label,"\xA0"),s(2),p("inline",!0),s(3),v(o.description?7:-1)}}function ve(t,i){if(t&1&&(a(0,"div",7)(1,"div",8),A(2,ge,9,3,"div",null,D),r()()),t&2){let o=h();s(2),w(o.items)}}function _e(t,i){if(t&1&&(a(0,"span",19),l(1),a(2,"mat-icon-button",20)(3,"mat-icon",21),l(4,"open_in_new"),r()(),l(5,"\xA0\xA0\xA0\xA0\xA0 "),r()),t&2){let o=h().$implicit;s(),C(" ",o.label,"\xA0 "),s(),p("routerLink",j(3,ue,o.value.id)),s(),p("inline",!0)}}function Ce(t,i){if(t&1&&(a(0,"div",18),g(1,_e,6,5,"span",19),u(2,"br"),r()),t&2){let o=i.$implicit;s(),v(o?1:-1)}}function xe(t,i){if(t&1&&(a(0,"div")(1,"div",6)(2,"a",12),l(3," sparql query "),r(),a(4,"span"),l(5,"\xA0\xA0|\xA0\xA0"),r(),a(6,"a",13),l(7,"FactGrid"),r()(),a(8,"div",14)(9,"mat-card",15)(10,"div",16),l(11),r(),a(12,"div",17),u(13,"hr"),a(14,"mat-card-content")(15,"div"),A(16,Ce,3,1,"div",18,he,!0),r()()()()()()),t&2){let o=h();s(6),p("routerLink",B(2,pe)),s(5),R(o.formerVisitsTitle),s(5),w(o.selectedParisItemsList)}}var He=(()=>{let i=class i{constructor(){this.dataService=d(de),this.changeDetector=d($),this.request=d(ne),this.setLanguage=d(ce),this.lang=d(ae),this.router=d(H),this.searchInput=new z,this.isDisplay=!1,this.data$=new y,this.searchQuery$=new _(""),this.items=[],this.baseGetURL="https://database.factgrid.de//w/api.php?action=wbgetentities&ids=",this.getUrlSuffix="&format=json&origin=*",this.formerVisitsTitle="you have visited:",this.selectedParisItemsList=(JSON.parse(localStorage.getItem("selectedItems"))||[]).filter(e=>e&&e.value&&e.value.id)}openItem(e){console.log("openItem called with:",e),sessionStorage.setItem("from","paris-search"),this.router.navigate(["/item",e.id],{state:{from:"paris-search"}})}ngOnInit(){this.formerVisitsTitle=this.lang.getTranslation("$1",this.lang.selectedLang),console.log("selectedParisItemsList:",this.selectedParisItemsList),this.labels=this.searchInput.valueChanges.pipe(b(400),f(e=>"Paris, "+e),M(e=>console.log(e)),I(e=>this.request.searchItem(e,this.lang.selectedLang)),f(e=>this.createList(e)),f(e=>e=="https://database.factgrid.de//w/api.php?action=wbgetentities&ids=&format=json&origin=*"?"https://database.factgrid.de//w/api.php?action=wbgetentities&ids=Q220375&format=json&origin=*":e),b(200),I(e=>this.request.getItem(e)),S(e=>e!==void 0),S(e=>e.entities!==void 0&&e.entities!==null),f(e=>Object.values(e.entities))).subscribe(e=>{this.items=this.setLanguage.item(e,this.lang.selectedLang),this.isDisplay=!0,this.items[0].id=="Q220375"&&(this.isDisplay=!1),this.changeDetector.detectChanges()})}createList(e){let n="",c="",m=e.search;m===void 0?m=[]:m=m;for(let x=0;x<m.length;x++)n=n+"|"+m[x].id;return n=n.slice(1),c=this.baseGetURL+n+this.getUrlSuffix,c}addParis(e){e="Paris, "+e}trackById(e,n){return n&&n.value?n.value.id:e}ngOnDestroy(){this.labels.unsubscribe()}};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=E({type:i,selectors:[["app-paris-search"]],decls:14,vars:3,consts:[["href",T`https://fonts.googleapis.com/icon?family=Material+Icons`,"rel","stylesheet"],[1,"cardBackground"],[1,"bigTitle"],["appearance","outlined",1,"mat-elevation-z12"],[1,"search-center2"],["matInput","","placeholder","Ex. rue de la Paix","value","rue de la Paix",3,"formControl"],[1,"search-center"],[1,"searchListSize"],[1,"details"],[1,"search-label"],[1,"internalLink",3,"click"],["color","primary",3,"inline"],["href","https://database.factgrid.de/query/#%23model%0A%0ASELECT%20%3Fitem%20%3Fviewer%20%3FitemLabel%20%20WHERE%20%7B%0A%20%20SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22%5BAUTO_LANGUAGE%5D%2Cen%22.%20%7D%0A%20%20%3Fitem%20wdt%3AP2%20wd%3AQ7%3B%0A%20%20%20%20%20%20%20%20wdt%3AP247%20wd%3AQ24708.%0A%20%20BIND%28STRAFTER%28STR%28%3Fitem%29%2C%20STR%28wd%3A%29%29%20AS%20%3FitemId%29%0A%20%20BIND%28IRI%28CONCAT%28%22https%3A%2F%2Fdatabase.factgrid.de%2Fviewer%2Fitem%2F%22%2C%20%3FitemId%29%29%20AS%20%3Fviewer%29%0A%7D%0A"],[3,"routerLink"],[1,"search-itemSelected"],["appearance","outlined",1,"search-itemSelected-mat-card"],[1,"selectedListTitle2"],[1,"selectedItemSize"],[1,"labelTitlePadding"],[1,"selectedItemText"],[1,"internalLink",3,"routerLink"],[1,"whiteButton",3,"inline"]],template:function(n,c){n&1&&(a(0,"head"),u(1,"link",0),r(),a(2,"body")(3,"div",1)(4,"div",2),l(5,"Paris on FactGrid"),r()(),a(6,"mat-card",3)(7,"mat-card-content")(8,"div",4)(9,"mat-form-field"),u(10,"input",5),r()()(),a(11,"div",6),g(12,ve,4,0,"div",7),g(13,xe,18,3,"div"),r()()()),n&2&&(s(10),p("formControl",c.searchInput),s(2),v(c.isDisplay==!0?12:-1),s(),v(c.isDisplay==!1?13:-1))},dependencies:[V,W,J,Q,q,U,G,N,ie,te,Z,ee,re,X,K,Y,le,oe,se],styles:[".example-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-width:300px}.example-header[_ngcontent-%COMP%]{min-height:64px;padding:8px 24px 0}.mat-form-field[_ngcontent-%COMP%]{font-size:14px;width:100%}.mat-table[_ngcontent-%COMP%]{overflow:auto;max-height:500px}.search-center[_ngcontent-%COMP%]{display:flex;justify-content:center}.search-center2[_ngcontent-%COMP%]{margin-top:40px;display:flex;justify-content:center}.search-label[_ngcontent-%COMP%]{font-weight:700}.search-itemSelected[_ngcontent-%COMP%]{margin-top:50px}.selectedItemSize[_ngcontent-%COMP%]{font-size:14px}"]});let t=i;return t})();export{He as ParisSearchComponent};
