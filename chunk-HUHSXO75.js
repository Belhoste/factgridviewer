import{a as xt,f as Oe,g as It}from"./chunk-LKNPJ45R.js";import"./chunk-F5X5MWHG.js";import{a as qe}from"./chunk-QE66N5DO.js";import{a as Mt}from"./chunk-NVEMQUNN.js";import{d as pe,j as Tt,k as ue,l as Pe}from"./chunk-3BZNMMR2.js";import{l as wt,n as Vt}from"./chunk-XZ3Q5VJG.js";import{l as kt}from"./chunk-65MISKIW.js";import{$a as Be,$b as re,A as q,Aa as ie,Ad as A,B as w,Ba as Y,Bd as Le,Ca as H,Cd as Ae,D as je,Da as h,Db as Ie,Ea as d,Ed as me,F as Xe,Fa as c,G as L,Ga as I,H as et,Hb as le,I as tt,Ib as ct,Jb as ae,K as y,Ka as T,Kb as dt,Lb as Te,Ma as S,N as Q,Na as p,Nb as pt,O as v,Oa as ot,Pa as Qe,Pb as oe,Qa as Ne,Qb as mt,Ra as R,Sa as E,Sb as _,Ta as W,Tb as ut,Ub as ne,Uc as Me,Vb as ht,Vc as se,Wa as nt,Wb as ft,Xb as bt,Ya as m,Yb as yt,Z as $e,Za as ve,Zb as gt,_a as x,_b as Ve,ab as Ue,ac as z,da as it,ea as s,hb as Ge,i as ee,ia as X,id as St,j as V,k as M,kb as rt,l as P,lb as Ye,md as Qt,na as B,nb as st,o as C,oa as lt,ob as xe,oc as _t,od as K,p as Se,pa as Re,pb as we,pc as Ct,qb as D,rb as j,sa as U,ta as G,td as ce,u as $,ud as de,v as te,w as Ke,wb as ke,xa as at,xd as vt,y as Je,ya as f,yd as Fe,z as Ze,za as b,zd as J}from"./chunk-UKF6WPGA.js";var Rt=["searchSelectInput"],Nt=["innerSelectSearch"],Bt=[[["",8,"mat-select-search-custom-header-content"]],[["","ngxMatSelectSearchClear",""]],[["","ngxMatSelectNoEntriesFound",""]]],Ut=[".mat-select-search-custom-header-content","[ngxMatSelectSearchClear]","[ngxMatSelectNoEntriesFound]"];function Gt(a,n){if(a&1){let i=T();d(0,"mat-checkbox",10),S("change",function(t){Q(i);let l=p();return v(l._emitSelectAllBooleanToParent(t.checked))}),c()}if(a&2){let i=p();h("color",i.matFormField==null?null:i.matFormField.color)("checked",i.toggleAllCheckboxChecked)("indeterminate",i.toggleAllCheckboxIndeterminate)("matTooltip",i.toggleAllCheckboxTooltipMessage)("matTooltipPosition",i.toggleAllCheckboxTooltipPosition)}}function Yt(a,n){a&1&&I(0,"mat-spinner",7)}function Ht(a,n){a&1&&Qe(0,1)}function zt(a,n){if(a&1&&I(0,"mat-icon",12),a&2){let i=p(2);h("svgIcon",i.closeSvgIcon)}}function Kt(a,n){if(a&1&&(d(0,"mat-icon"),m(1),c()),a&2){let i=p(2);s(),x(" ",i.closeIcon," ")}}function Jt(a,n){if(a&1){let i=T();d(0,"button",11),S("click",function(){Q(i);let t=p();return v(t._reset(!0))}),f(1,Ht,1,0)(2,zt,1,1,"mat-icon",12)(3,Kt,2,1,"mat-icon"),c()}if(a&2){let i=p();s(),b(i.clearIcon?1:i.closeSvgIcon?2:3)}}function Zt(a,n){a&1&&Qe(0,2)}function Xt(a,n){if(a&1&&m(0),a&2){let i=p(2);x(" ",i.noEntriesFoundLabel," ")}}function ei(a,n){if(a&1&&(d(0,"div",9),f(1,Zt,1,0)(2,Xt,1,1),c()),a&2){let i=p();s(),b(i.noEntriesFound?1:2)}}var ti=(()=>{class a{static \u0275fac=function(e){return new(e||a)};static \u0275dir=Re({type:a,selectors:[["","ngxMatSelectSearchClear",""]]})}return a})(),ii=["ariaLabel","clearSearchInput","closeIcon","closeSvgIcon","disableInitialFocus","disableScrollToActiveOnOptionsChanged","enableClearOnEscapePressed","hideClearSearchButton","noEntriesFoundLabel","placeholderLabel","preventHomeEndKeyPropagation","searching"],li=new tt("mat-selectsearch-default-options"),ai=(()=>{class a{static \u0275fac=function(e){return new(e||a)};static \u0275dir=Re({type:a,selectors:[["","ngxMatSelectNoEntriesFound",""]]})}return a})(),ge=(()=>{class a{matSelect;changeDetectorRef;_viewportRuler;matOption;matFormField;placeholderLabel="Suche";type="text";closeIcon="close";closeSvgIcon;noEntriesFoundLabel="Keine Optionen gefunden";clearSearchInput=!0;searching=!1;disableInitialFocus=!1;enableClearOnEscapePressed=!1;preventHomeEndKeyPropagation=!1;disableScrollToActiveOnOptionsChanged=!1;ariaLabel="dropdown search";showToggleAllCheckbox=!1;toggleAllCheckboxChecked=!1;toggleAllCheckboxIndeterminate=!1;toggleAllCheckboxTooltipMessage="";toggleAllCheckboxTooltipPosition="below";hideClearSearchButton=!1;alwaysRestoreSelectedOptionsMulti=!1;recreateValuesArray=!1;toggleAll=new G;searchSelectInput;innerSelectSearch;clearIcon;noEntriesFound;get value(){return this._formControl.value}_lastExternalInputValue;onTouched=()=>{};set _options(i){this._options$.next(i)}get _options(){return this._options$.getValue()}_options$=new V(null);optionsList$=this._options$.pipe(q(i=>i?i.changes.pipe(C(e=>e.toArray()),Ze(i.toArray())):P(null)));optionsLength$=this.optionsList$.pipe(C(i=>i?i.length:0));previousSelectedValues;_formControl=new _("",{nonNullable:!0});_showNoEntriesFound$=Se([this._formControl.valueChanges,this.optionsLength$]).pipe(C(([i,e])=>!!(this.noEntriesFoundLabel&&i&&e===this.getOptionsLengthOffset())));_onDestroy=new ee;activeDescendant;constructor(i,e,t,l,o,r){this.matSelect=i,this.changeDetectorRef=e,this._viewportRuler=t,this.matOption=l,this.matFormField=o,this.applyDefaultOptions(r)}applyDefaultOptions(i){if(i)for(let e of ii)Object.prototype.hasOwnProperty.call(i,e)&&(this[e]=i[e])}ngOnInit(){this.matOption?(this.matOption.disabled=!0,this.matOption._getHostElement().classList.add("contains-mat-select-search"),this.matOption._getHostElement().setAttribute("role","presentation")):console.error("<ngx-mat-select-search> must be placed inside a <mat-option> element"),this.matSelect.openedChange.pipe(Je(1),w(this._onDestroy)).subscribe(i=>{i?(this.updateInputWidth(),this.disableInitialFocus||this._focus()):this.clearSearchInput&&this._reset()}),this.matSelect.openedChange.pipe(Ke(1),q(()=>{this._options=this.matSelect.options;let i=this._options.toArray()[this.getOptionsLengthOffset()];return this._options.changes.pipe(je(()=>{setTimeout(()=>{let e=this._options.toArray(),t=e[this.getOptionsLengthOffset()],l=this.matSelect._keyManager;l&&this.matSelect.panelOpen&&t&&((!i||!this.matSelect.compareWith(i.value,t.value)||!l.activeItem||!e.find(r=>this.matSelect.compareWith(r.value,l.activeItem?.value)))&&l.setActiveItem(this.getOptionsLengthOffset()),setTimeout(()=>{this.updateInputWidth()})),i=t})}))})).pipe(w(this._onDestroy)).subscribe(),this._showNoEntriesFound$.pipe(w(this._onDestroy)).subscribe(i=>{this.matOption&&(i?this.matOption._getHostElement().classList.add("mat-select-search-no-entries-found"):this.matOption._getHostElement().classList.remove("mat-select-search-no-entries-found"))}),this._viewportRuler.change().pipe(w(this._onDestroy)).subscribe(()=>{this.matSelect.panelOpen&&this.updateInputWidth()}),this.initMultipleHandling(),this.optionsList$.pipe(w(this._onDestroy)).subscribe(()=>{this.changeDetectorRef.markForCheck()})}_emitSelectAllBooleanToParent(i){this.toggleAll.emit(i)}ngOnDestroy(){this._onDestroy.next(),this._onDestroy.complete()}_isToggleAllCheckboxVisible(){return this.matSelect.multiple&&this.showToggleAllCheckbox}_handleKeydown(i){(i.key&&i.key.length===1||this.preventHomeEndKeyPropagation&&(i.key==="Home"||i.key==="End"))&&i.stopPropagation(),this.matSelect.multiple&&i.key&&i.key==="Enter"&&setTimeout(()=>this._focus()),this.enableClearOnEscapePressed&&i.key==="Escape"&&this.value&&(this._reset(!0),i.stopPropagation())}_handleKeyup(i){if(i.key==="ArrowUp"||i.key==="ArrowDown"){let e=this.matSelect._getAriaActiveDescendant(),t=this._options.toArray().findIndex(l=>l.id===e);t!==-1&&(this.unselectActiveDescendant(),this.activeDescendant=this._options.toArray()[t]._getHostElement(),this.activeDescendant.setAttribute("aria-selected","true"),this.searchSelectInput.nativeElement.setAttribute("aria-activedescendant",e))}}writeValue(i){this._lastExternalInputValue=i,this._formControl.setValue(i),this.changeDetectorRef.markForCheck()}onBlur(){this.unselectActiveDescendant(),this.onTouched()}registerOnChange(i){this._formControl.valueChanges.pipe($(e=>e!==this._lastExternalInputValue),je(()=>this._lastExternalInputValue=void 0),w(this._onDestroy)).subscribe(i)}registerOnTouched(i){this.onTouched=i}_focus(){if(!this.searchSelectInput||!this.matSelect.panel)return;let i=this.matSelect.panel.nativeElement,e=i.scrollTop;this.searchSelectInput.nativeElement.focus(),i.scrollTop=e}_reset(i){this._formControl.setValue(""),i&&this._focus()}initMultipleHandling(){if(!this.matSelect.ngControl){this.matSelect.multiple&&console.error("the mat-select containing ngx-mat-select-search must have a ngModel or formControl directive when multiple=true");return}this.previousSelectedValues=this.matSelect.ngControl.value,this.matSelect.ngControl.valueChanges&&this.matSelect.ngControl.valueChanges.pipe(w(this._onDestroy)).subscribe(i=>{let e=!1;if(this.matSelect.multiple&&(this.alwaysRestoreSelectedOptionsMulti||this._formControl.value&&this._formControl.value.length)&&this.previousSelectedValues&&Array.isArray(this.previousSelectedValues)){(!i||!Array.isArray(i))&&(i=[]);let t=this.matSelect.options.map(l=>l.value);this.previousSelectedValues.forEach(l=>{!i.some(o=>this.matSelect.compareWith(o,l))&&!t.some(o=>this.matSelect.compareWith(o,l))&&(this.recreateValuesArray?i=[...i,l]:i.push(l),e=!0)})}this.previousSelectedValues=i,e&&this.matSelect._onChange(i)})}updateInputWidth(){if(!this.innerSelectSearch||!this.innerSelectSearch.nativeElement)return;let i=this.innerSelectSearch.nativeElement,e=null;for(;i&&i.parentElement;)if(i=i.parentElement,i.classList.contains("mat-select-panel")){e=i;break}e&&(this.innerSelectSearch.nativeElement.style.width=e.clientWidth+"px")}getOptionsLengthOffset(){return this.matOption?1:0}unselectActiveDescendant(){this.activeDescendant?.removeAttribute("aria-selected"),this.searchSelectInput.nativeElement.removeAttribute("aria-activedescendant")}static \u0275fac=function(e){return new(e||a)(X(ue),X(ke),X(St),X(pe,8),X(ce,8),X(li,8))};static \u0275cmp=B({type:a,selectors:[["ngx-mat-select-search"]],contentQueries:function(e,t,l){if(e&1&&(Ne(l,ti,5),Ne(l,ai,5)),e&2){let o;E(o=W())&&(t.clearIcon=o.first),E(o=W())&&(t.noEntriesFound=o.first)}},viewQuery:function(e,t){if(e&1&&(R(Rt,7,$e),R(Nt,7,$e)),e&2){let l;E(l=W())&&(t.searchSelectInput=l.first),E(l=W())&&(t.innerSelectSearch=l.first)}},inputs:{placeholderLabel:"placeholderLabel",type:"type",closeIcon:"closeIcon",closeSvgIcon:"closeSvgIcon",noEntriesFoundLabel:"noEntriesFoundLabel",clearSearchInput:"clearSearchInput",searching:"searching",disableInitialFocus:"disableInitialFocus",enableClearOnEscapePressed:"enableClearOnEscapePressed",preventHomeEndKeyPropagation:"preventHomeEndKeyPropagation",disableScrollToActiveOnOptionsChanged:"disableScrollToActiveOnOptionsChanged",ariaLabel:"ariaLabel",showToggleAllCheckbox:"showToggleAllCheckbox",toggleAllCheckboxChecked:"toggleAllCheckboxChecked",toggleAllCheckboxIndeterminate:"toggleAllCheckboxIndeterminate",toggleAllCheckboxTooltipMessage:"toggleAllCheckboxTooltipMessage",toggleAllCheckboxTooltipPosition:"toggleAllCheckboxTooltipPosition",hideClearSearchButton:"hideClearSearchButton",alwaysRestoreSelectedOptionsMulti:"alwaysRestoreSelectedOptionsMulti",recreateValuesArray:"recreateValuesArray"},outputs:{toggleAll:"toggleAll"},features:[rt([{provide:dt,useExisting:Xe(()=>a),multi:!0}])],ngContentSelectors:Ut,decls:13,vars:14,consts:[["innerSelectSearch",""],["searchSelectInput",""],["matInput","",1,"mat-select-search-input","mat-select-search-hidden"],[1,"mat-select-search-inner","mat-typography","mat-datepicker-content","mat-tab-header"],[1,"mat-select-search-inner-row"],["matTooltipClass","ngx-mat-select-search-toggle-all-tooltip",1,"mat-select-search-toggle-all-checkbox",3,"color","checked","indeterminate","matTooltip","matTooltipPosition"],["autocomplete","off",1,"mat-select-search-input",3,"keydown","keyup","blur","type","formControl","placeholder"],["diameter","16",1,"mat-select-search-spinner"],["mat-icon-button","","aria-label","Clear",1,"mat-select-search-clear"],[1,"mat-select-search-no-entries-found"],["matTooltipClass","ngx-mat-select-search-toggle-all-tooltip",1,"mat-select-search-toggle-all-checkbox",3,"change","color","checked","indeterminate","matTooltip","matTooltipPosition"],["mat-icon-button","","aria-label","Clear",1,"mat-select-search-clear",3,"click"],[3,"svgIcon"]],template:function(e,t){if(e&1){let l=T();ot(Bt),I(0,"input",2),d(1,"div",3,0)(3,"div",4),f(4,Gt,1,5,"mat-checkbox",5),d(5,"input",6,1),S("keydown",function(r){return Q(l),v(t._handleKeydown(r))})("keyup",function(r){return Q(l),v(t._handleKeyup(r))})("blur",function(){return Q(l),v(t.onBlur())}),c(),f(7,Yt,1,0,"mat-spinner",7),f(8,Jt,4,1,"button",8),Qe(9),c(),I(10,"mat-divider"),c(),f(11,ei,3,1,"div",9),D(12,"async")}e&2&&(s(),nt("mat-select-search-inner-multiple",t.matSelect.multiple)("mat-select-search-inner-toggle-all",t._isToggleAllCheckboxVisible()),s(3),b(t._isToggleAllCheckboxVisible()?4:-1),s(),h("type",t.type)("formControl",t._formControl)("placeholder",t.placeholderLabel),at("aria-label",t.ariaLabel),s(2),b(t.searching?7:-1),s(),b(!t.hideClearSearchButton&&t.value&&!t.searching?8:-1),s(3),b(j(12,12,t._showNoEntriesFound$)?11:-1))},dependencies:[le,z,Te,oe,ne,Oe,xt,wt,Vt,Me,K,Qt],styles:[".mat-select-search-hidden[_ngcontent-%COMP%]{visibility:hidden}.mat-select-search-inner[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;z-index:100;font-size:inherit;box-shadow:none;background-color:var(--mat-sys-surface-container, var(--mat-select-panel-background-color, white))}.mat-select-search-inner.mat-select-search-inner-multiple.mat-select-search-inner-toggle-all[_ngcontent-%COMP%]   .mat-select-search-inner-row[_ngcontent-%COMP%]{display:flex;align-items:center}.mat-select-search-input[_ngcontent-%COMP%]{box-sizing:border-box;width:100%;border:none;font-family:inherit;font-size:inherit;color:currentColor;outline:none;background-color:var(--mat-sys-surface-container, var(--mat-select-panel-background-color, white));padding:0 44px 0 16px;height:47px;line-height:47px}[dir=rtl][_nghost-%COMP%]   .mat-select-search-input[_ngcontent-%COMP%], [dir=rtl]   [_nghost-%COMP%]   .mat-select-search-input[_ngcontent-%COMP%]{padding-right:16px;padding-left:44px}.mat-select-search-input[_ngcontent-%COMP%]::placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color)}.mat-select-search-inner-toggle-all[_ngcontent-%COMP%]   .mat-select-search-input[_ngcontent-%COMP%]{padding-left:5px}.mat-select-search-no-entries-found[_ngcontent-%COMP%]{padding-top:8px}.mat-select-search-clear[_ngcontent-%COMP%]{position:absolute;right:4px;top:0}[dir=rtl][_nghost-%COMP%]   .mat-select-search-clear[_ngcontent-%COMP%], [dir=rtl]   [_nghost-%COMP%]   .mat-select-search-clear[_ngcontent-%COMP%]{right:auto;left:4px}.mat-select-search-spinner[_ngcontent-%COMP%]{position:absolute;right:16px;top:calc(50% - 8px)}[dir=rtl][_nghost-%COMP%]   .mat-select-search-spinner[_ngcontent-%COMP%], [dir=rtl]   [_nghost-%COMP%]   .mat-select-search-spinner[_ngcontent-%COMP%]{right:auto;left:16px}  .mat-mdc-option[aria-disabled=true].contains-mat-select-search{position:sticky;top:-8px;z-index:1;opacity:1;margin-top:-8px;pointer-events:all}  .mat-mdc-option[aria-disabled=true].contains-mat-select-search .mat-icon{margin-right:0;margin-left:0}  .mat-mdc-option[aria-disabled=true].contains-mat-select-search mat-pseudo-checkbox{display:none}  .mat-mdc-option[aria-disabled=true].contains-mat-select-search .mdc-list-item__primary-text{opacity:1}.mat-select-search-toggle-all-checkbox[_ngcontent-%COMP%]{padding-left:5px}[dir=rtl][_nghost-%COMP%]   .mat-select-search-toggle-all-checkbox[_ngcontent-%COMP%], [dir=rtl]   [_nghost-%COMP%]   .mat-select-search-toggle-all-checkbox[_ngcontent-%COMP%]{padding-left:0;padding-right:5px}"],changeDetection:0})}return a})();var he=(()=>{class a{static \u0275fac=function(e){return new(e||a)};static \u0275mod=lt({type:a});static \u0275inj=et({imports:[ge]})}return a})();var At=(()=>{let n=class n{constructor(){this.request=y(J),this.lang=y(A),this.langService="%20SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22"+this.lang.selectedLang+"%22%2C%22en%22.%20%7D%0A"}projectsListBuilding(e){let r=this.newSparqlAddress("https://database.factgrid.de/query/#SELECT%20DISTINCT%20%3Fitem%20%3FitemLabel%20WHERE%20%7B"+this.langService+"%3Fitem%20wdt%3AP2%20wd%3A"+e+".%7D%0A");return this.request.getList(r).pipe(C(u=>this.listFromSparql(u)))}listFromSparql(e){if(e!==void 0&&e.results!==void 0){let t=e.results.bindings;for(let l=0;l<t.length;l++)t[l].item.id=t[l].item.value.replace("https://database.factgrid.de/entity/","");t.sort((l,o)=>l.itemLabel.value.toUpperCase()<o.itemLabel.value.toUpperCase()?-1:o.itemLabel.value.toUpperCase()>o.itemLabel.value.toUpperCase()?1:0)}return e.results.bindings}newSparqlAddress(e){let t="https://database.factgrid.de/sparql?query=",l="https://database.factgrid.de/query/#";return e.includes("embed.html")&&(l="https://database.factgrid.de/query/embed.html#"),e!==void 0&&(e=e.replace(l,t)),e}};n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=L({token:n,factory:n.\u0275fac,providedIn:"root"});let a=n;return a})();var Ee=(()=>{let n=class n{constructor(){this.request=y(J),this.lang=y(A),this.langService="%20SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22"+this.lang.selectedLang+"%22%2C%22en%22.%20%7D%0A"}propertiesListBuilding(e){let r="https://database.factgrid.de/query/#SELECT%20DISTINCT%20%3Fitem%20%3FitemLabel%20%3FpropertyType%20WHERE%20%7B"+this.langService+"VALUES%20%3Fproperties%20%7B%20wd%3A"+e+"%20wd%3AQ1089730%7D%20%3Fitem%20wdt%3AP8%20%3Fproperties%3B%20wikibase%3ApropertyType%20%3FpropertyType%20MINUS%20%7B%20%3Fproperty%20wikibase%3ApropertyType%20wikibase%3AUrl%20%7D%20MINUS%20%7B%20%3Fitem%20wikibase%3ApropertyType%20wikibase%3AExternalId%20%7D%20MINUS%20%7B%20%3Fitem%20wikibase%3ApropertyType%20wikibase%3AUrl%20%7D%20MINUS%20%7B%20%3Fitem%20wikibase%3ApropertyType%20wikibase%3AGlobeCoordinate%20%7D%20MINUS%20%7B%20%3Fitem%20wikibase%3ApropertyType%20wikibase%3AGeoShape%20%7D%20MINUS%20%7B%20%3Fitem%20wikibase%3ApropertyType%20wikibase%3ACommonsMedia%20%7D%20%7D%20ORDER%20BY%20%3FitemLabel%0A";console.log(r);let u=this.newSparqlAddress(r);return console.log(u),this.request.getList(u).pipe(C(g=>this.transformListFromSparql(g)))}propertiesList2Building(e){let t="https://database.factgrid.de/query/#SELECT%20DISTINCT%20%3Fitem%20%3FitemLabel%20WHERE%20%7B",l="%3Fitem%20wdt%3AP2%20wd%3A",o=".%7D%0A";console.log(t+this.langService+l+e+o);let r=this.newSparqlAddress(t+this.langService+l+e+o);return this.request.getList(r).pipe(C(u=>this.listFromSparql(u)))}get qualifierPropertiesListBuilding(){let e="https://database.factgrid.de/query/#SELECT%20DISTINCT%20%3Fitem%20%3FitemLabel%20%3FpropertyType%20%20WHERE%20%7B%20",t="%20VALUES%20%3Fqualifier%20%7B%20wd%3AQ514317%20wd%3AQ21403%20%7D%0A%20%3Fitem%20wikibase%3ApropertyType%20%3FpropertyType%3B%0A%20%20%20%20%20%20%20%20%20%20%20wdt%3AP8%20%3Fqualifier.%0A%7D%0AORDER%20BY%20%3FitemLabel",l,o=this.newSparqlAddress(e+this.langService+t);return this.request.getList(o).pipe(C(r=>this.listFromSparql(r)),C(r=>this.transformListFromSparql(r)))}listFromSparql(e){if(e!==void 0&&e.results!==void 0){let t=e.results.bindings;for(let l=0;l<t.length;l++)t[l].item.id=t[l].item.value.replace("https://database.factgrid.de/entity/","");t.sort((l,o)=>l.itemLabel.value.toUpperCase()<o.itemLabel.value.toUpperCase()?-1:o.itemLabel.value.toUpperCase()>o.itemLabel.value.toUpperCase()?1:0)}return e.results.bindings}newSparqlAddress(e){let t="https://database.factgrid.de/sparql?query=",l="https://database.factgrid.de/query/#";return e.includes("embed.html")&&(l="https://database.factgrid.de/query/embed.html#"),e!==void 0&&(e=e.replace(l,t)),e}deepNatureOf(){let e="Instance of (deep search)";return this.lang.selectedLang==="de"&&(e="Ist ein(e) (vertiefte Suche)"),this.lang.selectedLang==="fr"&&(e="Nature de l'\xE9l\xE9ment (recherche approfondie)"),this.lang.selectedLang==="es"&&(e="Instancia de (investigaci\xF3n en profundidad)"),this.lang.selectedLang==="it"&&(e="\xC8 (ricerca approfondita)"),e}changeList(e){if(e!==void 0)for(let t=0;t<e.length;t++){let l=this.removeSubstring(e[t].propertyType.value,"http://wikiba.se/ontology#");e[t].itemLabel.label=e[t].itemLabel.value+" ("+l+")"}return e}transformListFromSparql(e){return e!==void 0&&e.results!==void 0?e.results.bindings.map(l=>{let o=l.itemLabel.value,r=l.propertyType.value.replace("http://wikiba.se/ontology#","");return{value:o,id:l.item.value.replace("https://database.factgrid.de/entity/",""),type:r,label:`${o} (${r})`}}).sort((l,o)=>l.value.toUpperCase()<o.value.toUpperCase()?-1:l.value.toUpperCase()>o.value.toUpperCase()?1:0):[]}removeSubstring(e,t){let l=new RegExp(t,"g");return e.replace(l,"")}};n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=L({token:n,factory:n.\u0275fac,providedIn:"root"});let a=n;return a})();var ri=["multiSelect"];function si(a,n){if(a&1&&(d(0,"mat-option",6),m(1),c()),a&2){let i=n.$implicit;h("value",i.item.id),s(),x(" ",i.itemLabel.value," ")}}var Ot=(()=>{let n=class n{constructor(){this.setLanguage=y(qe),this.lang=y(A),this.formBuilder=y(Ve),this.placeholderLabel="Search",this.projectSearchInput=new _,this.projectMultiFilterCtrl=new _(""),this.filteredProjectMulti=new M(1),this.selectionChange=new G,this._onDestroy=new ee}set data(e){this._data=e,this.filteredProjectMulti.next(this.data.slice())}get data(){return this._data}ngOnInit(){this.projectMultiFilterCtrl.valueChanges.pipe(w(this._onDestroy)).subscribe(()=>{this.filterProjectMulti()})}ngAfterViewInit(){this.setInitialValue()}setInitialValue(){this.filteredProjectMulti}onSelectChange(e){}filterProjectMulti(){if(!this.data)return;let e=this.projectMultiFilterCtrl.value;if(e)e=e.toLowerCase();else{this.filteredProjectMulti.next(this.data.slice());return}this.filteredProjectMulti.next(this.data.filter(t=>t.itemLabel.value.toLowerCase().indexOf(e)>-1))}onSelection(e){this.selectionChange.emit(new Tt(this.multiSelect,e.value))}ngOnDestroy(){}};n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=B({type:n,selectors:[["app-project-select"]],viewQuery:function(t,l){if(t&1&&R(ri,7),t&2){let o;E(o=W())&&(l.multiSelect=o.first)}},inputs:{placeholderLabel:"placeholderLabel",data:"data"},outputs:{selectionChange:"selectionChange"},decls:9,vars:6,consts:[["multiSelect",""],[1,"cardBackground"],["id","projects",1,"search-center2"],["placeholder","Projects",3,"selectionChange","formControl","multiple"],["placeholderLabel","Search","noEntriesFoundLabel","Not found",3,"formControl"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,l){if(t&1){let o=T();d(0,"div",1)(1,"div",2)(2,"mat-form-field")(3,"mat-select",3,0),S("selectionChange",function(u){return Q(o),v(l.onSelection(u))}),d(5,"mat-option"),I(6,"ngx-mat-select-search",4),c(),U(7,si,2,2,"mat-option",5),D(8,"async"),c()()()()}t&2&&(s(3),h("formControl",l.projectSearchInput)("multiple",!0),s(3),h("formControl",l.projectMultiFilterCtrl),s(),h("ngForOf",j(8,4,l.filteredProjectMulti)))},dependencies:[ae,Ie,le,z,oe,ne,re,me,se,K,Pe,ce,ue,pe,de,he,ge],styles:[".search-center2[_ngcontent-%COMP%]{margin-top:20px;display:flex;justify-content:center}#projects[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:60vw}@media (max-width: 959.98px){#projects[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:90vw}}"]});let a=n;return a})();var Pt=(()=>{let n=class n{constructor(){this.request=y(J),this.lang=y(A),this.baseGetURL="https://database.factgrid.de//w/api.php?action=wbgetentities&ids=",this.getUrlSuffix="&format=json&origin=*"}input(e){e.pipe(te(400),q(t=>this.request.searchItem(t,this.lang.selectedLang)),C(t=>this.createList(t)),C(t=>t=="https://database.factgrid.de//w/api.php?action=wbgetentities&ids=&format=json&origin=*"?"https://database.factgrid.de//w/api.php?action=wbgetentities&ids=Q220375&format=json&origin=*":t),te(200),q(t=>this.request.getItem(t)),$(t=>t!==void 0))}createList(e){let t="",l="",o=e.search;o===void 0?o=[]:o=o;for(let r=0;r<o.length;r++)t=t+"|"+o[r].id;return t=t.slice(1),l=this.baseGetURL+t+this.getUrlSuffix,l}};n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=L({token:n,factory:n.\u0275fac,providedIn:"root"});let a=n;return a})();var O=[{label:"?activity",id:"Q256699",order:0},{label:"?archive",id:"Q21870",order:0},{label:"?artefact",id:"Q101755",order:0},{label:"?book",id:"Q100626",order:0},{label:"?career",id:"Q77493",order:0},{label:"?city",id:"Q77500",order:0},{label:"?context",id:"Q77500",order:0},{label:"?country",id:"Q77500",order:0},{label:"?date",id:"Q77483",order:0},{label:"?document",id:"Q21870",order:0},{label:"?education",id:"Q100631",order:0},{label:"?event",id:"Q77499",order:0},{label:"?freemasonry",id:"Q23197",order:0},{label:"?group",id:"Q77498",order:0},{label:"?human",id:"Q77478",order:0},{label:"?human work",id:"Q77495",order:0},{label:"?name",id:"Q77488",order:0},{label:"?object",id:"Q101755",order:0},{label:"?organisation",id:"Q77501",order:0},{label:"?person",id:"Q77478",order:0},{label:"?people",id:"Q77478",order:0},{label:"?place",id:"Q77500",order:0},{label:"?printed document",id:"Q100626",order:0},{label:"?profession",id:"Q256699",order:0},{label:"?publication",id:"Q77502",order:0}],qt=[{label:"write literal string",type:"String",col:0},{label:"write date : YYYY-MM-DD",type:"Time",col:0},{label:"write number",type:"Quantity",col:0},{label:"None",type:"Any",col:2},{label:"None",type:"Any",col:3},{label:"None",type:"Any",col:4},{label:"?date",type:"Time",col:0},{label:"?date1",type:"Time",col:1},{label:"?date2",type:"Time",col:2},{label:"?date3",type:"Time",col:3},{label:"?date4",type:"Time",col:4},{label:"?date5",type:"Time",col:5},{label:"?string",type:"String",col:0},{label:"?string1",type:"String",col:1},{label:"?string2",type:"String",col:2},{label:"?string3",type:"String",col:3},{label:"?string4",type:"String",col:4},{label:"?amount",type:"Quantity",col:0},{label:"?amount1",type:"Quantity",col:1},{label:"?amount2",type:"Quantity",col:2},{label:"?amount3",type:"Quantity",col:3},{label:"?number",type:"Quantity",col:0},{label:"?number1",type:"Quantity",col:1},{label:"?number2",type:"Quantity",col:2},{label:"?number3",type:"Quantity",col:3}],Et=[1,5,6,8,10,13,16,17,19,20,21,23],fe=[[{label:"?activity",id:"Q256699",col:0},{label:"?archive",id:"Q21870",col:1},{label:"?artefact",id:"Q101755",col:2},{label:"?book",id:"Q100626",col:3},{label:"?career",id:"Q77493",col:4},{label:"?city",id:"Q77500",col:5},{label:"?country",id:"Q77500",col:6},{label:"?date",id:"Q77483",col:7},{label:"?document",id:"Q21870",col:8},{label:"?education",id:"Q100631",col:9},{label:"?event",id:"Q77499",col:10},{label:"?freemasonry",id:"Q23197",col:11},{label:"?group",id:"Q77498",col:12},{label:"?human",id:"Q77478",col:13},{label:"?human work",id:"Q77495",col:14},{label:"?name",id:"Q77488",col:15},{label:"?object",id:"Q101755",col:16},{label:"?organisation",id:"Q77501",col:17},{label:"?people",id:"Q77478",col:18},{label:"?person",id:"Q77478",col:19},{label:"?place",id:"Q77500",col:20},{label:"?printed document",id:"Q100626",col:21},{label:"?profession",id:"Q256699",col:22},{label:"?publication",id:"Q77502",col:23}],[{label:"?activity1",id:"Q256699",col:0},{label:"?archive1",id:"Q21870",col:1},{label:"?artefact1",id:"Q101755",col:2},{label:"?book1",id:"Q100626",col:3},{label:"?career1",id:"Q77493",col:4},{label:"?city1",id:"Q77500",col:5},{label:"?country1",id:"Q77500",col:6},{label:"?date1",id:"Q77483",col:7},{label:"?document1",id:"Q21870",col:8},{label:"?education1",id:"Q100631",col:9},{label:"?event1",id:"Q77499",col:10},{label:"?freemasonry1",id:"Q23197",col:11},{label:"?group1",id:"Q77498",col:12},{label:"?human1",id:"Q77478",col:13},{label:"?human work1",id:"Q77495",col:14},{label:"?name1",id:"Q77488",col:15},{label:"?object1",id:"Q101755",col:16},{label:"?organisation1",id:"Q77501",col:17},{label:"?people1",id:"Q77478",col:18},{label:"?person1",id:"Q77478",col:19},{label:"?place1",id:"Q77500",col:20},{label:"?printed document1",id:"Q100626",col:21},{label:"?profession1",id:"Q256699",col:22},{label:"?publication1",id:"Q77502",col:23}],[{label:"?activity2",id:"Q256699",col:0},{label:"?archive2",id:"Q21870",col:1},{label:"?artefact2",id:"Q101755",col:2},{label:"?book2",id:"Q100626",col:3},{label:"?career2",id:"Q77493",col:4},{label:"?city2",id:"Q77500",col:5},{label:"?country2",id:"Q77500",col:6},{label:"?date2",id:"Q77483",col:7},{label:"?document2",id:"Q21870",col:8},{label:"?education2",id:"Q100631",col:9},{label:"?event2",id:"Q77499",col:10},{label:"?freemasonry2",id:"Q23197",col:11},{label:"?group2",id:"Q77498",col:12},{label:"?human2",id:"Q77478",col:13},{label:"?human work2",id:"Q77495",col:14},{label:"?name2",id:"Q77488",col:15},{label:"?object2",id:"Q101755",col:16},{label:"?organisation2",id:"Q77501",col:17},{label:"?people2",id:"Q77478",col:18},{label:"?person2",id:"Q77478",col:19},{label:"?place2",id:"Q77500",col:20},{label:"?printed document2",id:"Q100626",col:21},{label:"?profession2",id:"Q256699",col:22},{label:"?publication2",id:"Q77502",col:23}],[{label:"?activity3",id:"Q256699",col:0},{label:"?archive3",id:"Q21870",col:1},{label:"?artefact3",id:"Q101755",col:2},{label:"?book3",id:"Q100626",col:3},{label:"?career3",id:"Q77493",col:4},{label:"?city3",id:"Q77500",col:5},{label:"?country3",id:"Q77500",col:6},{label:"?date3",id:"Q77483",col:7},{label:"?document3",id:"Q21870",col:8},{label:"?education3",id:"Q100631",col:9},{label:"?event3",id:"Q77499",col:10},{label:"?freemasonry3",id:"Q23197",col:11},{label:"?group3",id:"Q77498",col:12},{label:"?human3",id:"Q77478",col:13},{label:"?human work3",id:"Q77495",col:14},{label:"?name3",id:"Q77488",col:15},{label:"?object3",id:"Q101755",col:16},{label:"?organisation3",id:"Q77501",col:17},{label:"?people3",id:"Q77478",col:18},{label:"?person3",id:"Q77478",col:19},{label:"?place3",id:"Q77500",col:20},{label:"?printed document3",id:"Q100626",col:21},{label:"?profession3",id:"Q256699",col:22},{label:"?publication3",id:"Q77502",col:23}],[{label:"?activity4",id:"Q256699",col:0},{label:"?archive4",id:"Q21870",col:1},{label:"?artefact4",id:"Q101755",col:2},{label:"?book4",id:"Q100626",col:3},{label:"?career4",id:"Q77493",col:4},{label:"?city4",id:"Q77500",col:5},{label:"?country4",id:"Q77500",col:6},{label:"?date4",id:"Q77483",col:7},{label:"?document4",id:"Q21870",col:8},{label:"?education4",id:"Q100631",col:9},{label:"?event4",id:"Q77499",col:10},{label:"?freemasonry4",id:"Q23197",col:11},{label:"?group4",id:"Q77498",col:12},{label:"?human4",id:"Q77478",col:13},{label:"?human work4",id:"Q77495",col:14},{label:"?name4",id:"Q77488",col:15},{label:"?object4",id:"Q101755",col:16},{label:"?organisation4",id:"Q77501",col:17},{label:"?people4",id:"Q77478",col:18},{label:"?person4",id:"Q77478",col:19},{label:"?place4",id:"Q77500",col:20},{label:"?printed document4",id:"Q100626",col:21},{label:"?profession4",id:"Q256699",col:22},{label:"?publication4",id:"Q77502",col:23}],[{label:"?activity5",id:"Q256699",col:0},{label:"?archive5",id:"Q21870",col:1},{label:"?artefact5",id:"Q101755",col:2},{label:"?book5",id:"Q100626",col:3},{label:"?career5",id:"Q77493",col:4},{label:"?city5",id:"Q77500",col:5},{label:"?country5",id:"Q77500",col:6},{label:"?date5",id:"Q77483",col:7},{label:"?document5",id:"Q21870",col:8},{label:"?education5",id:"Q100631",col:9},{label:"?event5",id:"Q77499",col:10},{label:"?freemasonry5",id:"Q23197",col:11},{label:"?group5",id:"Q77498",col:12},{label:"?human5",id:"Q77478",col:13},{label:"?human work5",id:"Q77495",col:14},{label:"?name5",id:"Q77488",col:15},{label:"?object5",id:"Q101755",col:16},{label:"?organisation5",id:"Q77501",col:17},{label:"?people5",id:"Q77478",col:18},{label:"?person5",id:"Q77478",col:19},{label:"?place5",id:"Q77500",col:20},{label:"?printed document5",id:"Q100626",col:21},{label:"?profession5",id:"Q256699",col:22},{label:"?publication5",id:"Q77502",col:23}]];var be=(()=>{let n=class n{constructor(){this.mutator=new V(fe),this.mutator$=this.mutator.asObservable(),this.mutatorForItemValue=new V(fe),this.mutatorForItemValue$=this.mutator.asObservable(),this.mutatorForNextStatement=new V(fe),this.mutatorForNextStatement$=this.mutatorForNextStatement.asObservable(),this.itemTypes=new V(O),this.itemTypes$=this.itemTypes.asObservable(),this.itemTypes1=new V([]),this.itemTypes1$=this.itemTypes1.asObservable(),this.itemTypes2=new V([]),this.itemTypes2$=this.itemTypes2.asObservable(),this.formerItemTypes=new V([O]),this.formerItemTypes$=this.formerItemTypes.asObservable(),this.propertiesList=new V([]),this.propertiesList$=this.propertiesList.asObservable(),this.currentStatement=new V(0),this.currentStatement$=this.currentStatement.asObservable()}updateMutator(e){this.mutator.next(e)}updateMutatorForItemValue(e){this.mutatorForItemValue.next(e)}updateMutatorForNextStatement(e){this.mutatorForNextStatement.next(e)}lastItemTypes$(e){return e.pipe(C(t=>t[t.length-1]))}updateItemTypes(e){this.itemTypes.next(e)}updateItemTypes1(e){this.itemTypes1.next(e)}updateItemTypes2(e){this.itemTypes2.next(e)}updateFormerItemTypes(e){this.formerItemTypes.next(e)}updatePropertiesList(e){this.propertiesList.next(e)}updateCurrentStatement(e){this.currentStatement.next(e)}};n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=L({token:n,factory:n.\u0275fac,providedIn:"root"});let a=n;return a})();var Wt=(()=>{let n=class n{constructor(){}itemType(e,t){return e&&e.length>t?e.at(t).get("value.itemType"):null}itemValue(e,t){return e.at(t).get("value.itemValue")}propertyValues(e,t){return e.at(t).get("properties")}literalValue(e,t){return e.at(t).get("value.literalValue")}literalString(e,t){return e.at(t).get("value.literalString")}qualifiers(e,t){return e.at(t).get("qualifiers")}qualifierProperty(e,t){return e.at(t).get("qualifierProperty")}qualifierValue(e,t){return e.at(t).controls.value.get("qualifierValue")}qualifierLiteralValue(e,t){return e.at(t).controls.value.get("qualifierLiteralValue")}qualifierLiteralString(e,t){return e.at(t).controls.value.get("qualifierLiteralString")}patchQualifierValue(e,t,l){return this.qualifierValue(t,l).patchValue("value")}};n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=L({token:n,factory:n.\u0275fac,providedIn:"root"});let a=n;return a})();var di=["matRef"],pi=["singleSelect"],mi=["multiSelect"],He=(a,n,i,e,t)=>[a,n,i,e,t],ze=(a,n,i,e)=>[a,n,i,e],ui=(a,n,i)=>[a,n,i],hi=(a,n)=>n.itemType,fi=(a,n)=>n.qualifierProperty[1];function bi(a,n){a&1&&m(0," (optional) ")}function yi(a,n){if(a&1&&m(0),a&2){let i=p().$implicit;Be(" statement ",i.itemType[0]+1," : subject: ",i.itemType[1]," ")}}function gi(a,n){if(a&1&&m(0),a&2){let i=n.$implicit;ve(i[3])}}function _i(a,n){if(a&1&&(m(0," -> property: "),Y(1,gi,1,1,null,null,ie)),a&2){let i=p().$implicit;s(),H(i.properties)}}function Ci(a,n){if(a&1&&m(0),a&2){let i=p(2).$implicit;x(" ",i.value.itemValue[1]," ")}}function Si(a,n){if(a&1&&m(0),a&2){let i=p(2).$implicit;x(" ",i.value.literalValue[1]," ")}}function Qi(a,n){if(a&1&&m(0),a&2){let i=p(2).$implicit;x(" ",i.value.literalString," ")}}function vi(a,n){if(a&1&&(m(0," -> object: "),f(1,Ci,1,1),f(2,Si,1,1),f(3,Qi,1,1)),a&2){let i=p().$implicit;s(),b(i.value.itemValue?1:-1),s(),b(i.value.literalValue?2:-1),s(),b(i.value.literalString?3:-1)}}function xi(a,n){if(a&1&&m(0),a&2){let i=p().$implicit;Be(" qualifier ",i.qualifierProperty[1]+1," : property: ",i.qualifierProperty[4])}}function wi(a,n){if(a&1&&m(0),a&2){let i=p(2).$implicit;x(" -> object: ",i.value.qualifierValue[2])}}function ki(a,n){if(a&1&&m(0),a&2){let i=p(2).$implicit;x(" -> object: ",i.value.qualifierLiteralValue[2])}}function Ii(a,n){if(a&1&&m(0),a&2){let i=p(2).$implicit;x(" -> object: ",i.value.qualifierLiteralString)}}function Ti(a,n){if(a&1&&(f(0,wi,1,1),f(1,ki,1,1),f(2,Ii,1,1)),a&2){let i=p().$implicit;b(i.value.qualifierValue?0:-1),s(),b(i.value.qualifierLiteralValue?1:-1),s(),b(i.value.qualifierLiteralString?2:-1)}}function Vi(a,n){if(a&1&&(d(0,"div",8),f(1,xi,1,2),f(2,Ti,3,3),c()),a&2){let i=n.$implicit;s(),b(i.qualifierProperty?1:-1),s(),b(i.value?2:-1)}}function Mi(a,n){if(a&1&&(d(0,"div",2),Y(1,Vi,3,2,"div",8,fi),c()),a&2){let i=p().$implicit;s(),H(i.qualifiers)}}function Fi(a,n){if(a&1&&(d(0,"div",8),f(1,bi,1,0),f(2,yi,1,2),f(3,_i,3,0),f(4,vi,4,3),c(),f(5,Mi,3,0,"div",2)),a&2){let i=n.$implicit;s(),b(i.optional?1:-1),s(),b(i.itemType?2:-1),s(),b(i.properties?3:-1),s(),b(i.value?4:-1),s(),b(i.qualifiers?5:-1)}}function Li(a,n){if(a&1&&Y(0,Fi,6,5,null,null,hi),a&2){let i=p();H(i.query.value.statements)}}function Ai(a,n){if(a&1&&(d(0,"mat-option",19),m(1),c()),a&2){let i=n.$implicit,e=p().$index;h("value",we(2,He,e,i.label,i.value,i.id,i.order)),s(),x(" ",i.label," ")}}function Oi(a,n){if(a&1&&(d(0,"mat-option",19),m(1),c()),a&2){let i=n.$implicit,e=p().$index;h("value",xe(2,ze,e,i.value,i.id,i.type)),s(),x(" ",i.label," ")}}function Pi(a,n){a&1&&(d(0,"div",17),m(1," Select several properties only if they have the same type "),c())}function qi(a,n){if(a&1&&(d(0,"mat-option",19),m(1),c()),a&2){let i=n.$implicit,e=p(2).$index;h("value",xe(4,ze,e,i.label,i.col,i.id)),s(),Ue(" ",i.label,"",i.separator,"",i.description," ")}}function Ei(a,n){if(a&1){let i=T();d(0,"mat-form-field",11)(1,"mat-select",20,0),S("selectionChange",function(t){Q(i);let l=p(2);return v(l.onValueSelect(t))}),d(3,"mat-option"),I(4,"ngx-mat-select-search",16),c(),U(5,qi,2,9,"mat-option",14),D(6,"async"),c()()}if(a&2){let i=p().$index,e=p();s(4),h("formControl",e.itemValueFilterCtrl),s(),h("ngForOf",j(6,2,e.filteredItemValuesArray[i]))}}function Wi(a,n){if(a&1&&(d(0,"mat-option",19),m(1),c()),a&2){let i=n.$implicit,e=p(2).$index;h("value",st(2,ui,e,i.label,i.col)),s(),x(" ",i.label," ")}}function Di(a,n){if(a&1){let i=T();d(0,"mat-form-field",11)(1,"mat-select",21,0),S("selectionChange",function(t){Q(i);let l=p(2);return v(l.onLiteralValueSelect(t))}),Y(3,Wi,2,6,"mat-option",19,ie),c()(),d(5,"mat-form-field",11),I(6,"input",22),c()}if(a&2){let i=p(2);s(),h("placeholder",Ge(i.placeholderForLiteralValue)),s(2),H(i.literalVariables),s(3),h("placeholder",Ge(i.placeholderForLiteralString))}}function ji(a,n){if(a&1&&(d(0,"mat-option",19),m(1),c()),a&2){let i=n.$implicit,e=p(2).$index,t=p(2).$index;h("value",we(2,He,t,e,i.id,i.propertyType.id,i.itemLabel.value)),s(),x(" ",i.itemLabel.label," ")}}function $i(a,n){if(a&1&&(d(0,"mat-option",19),m(1),c()),a&2){let i=n.$implicit,e=p(3).$index,t=p(2).$index;h("value",we(4,He,t,e,i.label,i.col,i.id)),s(),Ue(" ",i.label,"",i.separator,"",i.description," ")}}function Ri(a,n){if(a&1){let i=T();d(0,"mat-form-field",11)(1,"mat-select",25,0),S("selectionChange",function(t){Q(i);let l=p(5);return v(l.onQualifierValueSelect(t))}),d(3,"mat-option"),I(4,"ngx-mat-select-search",16),c(),U(5,$i,2,10,"mat-option",14),D(6,"async"),c()()}if(a&2){let i=p(5);s(4),h("formControl",i.qualifierValueFilterCtrl),s(),h("ngForOf",j(6,2,i.filteredQualifierValues))}}function Ni(a,n){if(a&1&&(d(0,"mat-option",19),m(1),c()),a&2){let i=n.$implicit,e=p(3).$index,t=p(2).$index;h("value",xe(2,ze,t,e,i.label,i.col)),s(),x(" ",i.label," ")}}function Bi(a,n){a&1&&(d(0,"mat-form-field",11),I(1,"input",27),c())}function Ui(a,n){if(a&1){let i=T();d(0,"mat-form-field",11)(1,"mat-select",26,0),S("selectionChange",function(t){Q(i);let l=p(5);return v(l.onQualifierLiteralValueSelect(t))}),Y(3,Ni,2,7,"mat-option",19,ie),c()(),f(5,Bi,2,0,"mat-form-field",11)}if(a&2){let i=p(5);s(3),H(i.qualifierLiteralVariables),s(2),b(i.isLiteralStringOnQualifier?5:-1)}}function Gi(a,n){if(a&1){let i=T();d(0,"div",2),m(1),d(2,"span"),m(3,"\xA0\xA0\xA0\xA0\xA0\xA0"),d(4,"mat-checkbox",10),m(5,"Optional"),c()(),m(6,":"),c(),d(7,"mat-form-field",11)(8,"mat-select",24),S("selectionChange",function(t){Q(i);let l=p(4);return v(l.onQualifierPropertySelect(t))}),d(9,"mat-option"),I(10,"ngx-mat-select-search",16),c(),U(11,ji,2,8,"mat-option",14),D(12,"async"),c()(),d(13,"div",18),f(14,Ri,7,4,"mat-form-field",11),f(15,Ui,6,1),c()}if(a&2){let i=p().$index,e=p(3);s(),x("Qualifier ",i+1," "),s(9),h("formControl",e.qualifierPropertyFilterCtrl),s(),h("ngForOf",j(12,5,e.filteredQualifierProperties)),s(3),b(e.isWikibaseItemOnQualifier===!0?14:-1),s(),b(e.isLiteralOnQualifier===!0?15:-1)}}function Yi(a,n){if(a&1&&(d(0,"div",9),f(1,Gi,16,7),c()),a&2){let i=n.$index,e=p(2).$index,t=p();h("formGroupName",i),s(),b(i===t.qualifiers(e).length-1?1:-1)}}function Hi(a,n){if(a&1){let i=T();d(0,"div",4)(1,"button",28),S("click",function(){Q(i);let t=p(2).$index,l=p();return v(l.removeQualifiers(t,l.j))}),m(2,"Remove qualifier"),c()()}}function zi(a,n){if(a&1&&(d(0,"div",23),Y(1,Yi,2,2,"div",9,ie),c(),f(3,Hi,3,0,"div",4)),a&2){let i=p().$index,e=p();s(),H(e.qualifiers(i).controls),s(2),b(e.isRemoveQualifier?3:-1)}}function Ki(a,n){if(a&1){let i=T();d(0,"div",4)(1,"button",28),S("click",function(){Q(i);let t=p().$index,l=p();return v(l.addQualifiers(t))}),m(2,"Add qualifier"),c()()}}function Ji(a,n){if(a&1){let i=T();d(0,"div",4)(1,"button",28),S("click",function(){Q(i);let t=p().$index,l=p();return v(l.removeStatements(t))}),m(2,"Remove statement"),c()()}}function Zi(a,n){if(a&1){let i=T();d(0,"div",4)(1,"button",28),S("click",function(){Q(i);let t=p(2);return v(t.addStatements())}),m(2,"Add Statement"),c()()}}function Xi(a,n){if(a&1){let i=T();d(0,"div",9)(1,"div",2),m(2),d(3,"span"),m(4,"\xA0\xA0\xA0\xA0\xA0\xA0"),d(5,"mat-checkbox",10),m(6,"Optional"),c()(),m(7,":"),c(),d(8,"mat-form-field",11)(9,"mat-select",12,0),S("selectionChange",function(t){Q(i);let l=p();return v(l.onItemTypeSelect(t))}),d(11,"mat-option"),I(12,"ngx-mat-select-search",13),c(),U(13,Ai,2,8,"mat-option",14),D(14,"async"),c()(),d(15,"mat-form-field",11)(16,"mat-select",15),S("selectionChange",function(t){Q(i);let l=p();return v(l.onPropertySelect(t))}),d(17,"mat-option"),I(18,"ngx-mat-select-search",16),c(),U(19,Oi,2,7,"mat-option",14),D(20,"async"),c(),f(21,Pi,2,0,"div",17),c(),d(22,"div",18),f(23,Ei,7,4,"mat-form-field",11),f(24,Di,7,4),c(),f(25,zi,4,1),f(26,Ki,3,0,"div",4),c(),f(27,Ji,3,0,"div",4),f(28,Zi,3,0,"div",4)}if(a&2){let i=n.$index,e=p();h("formGroupName",i),s(2),x("Statement ",i+1," "),s(10),h("formControl",e.itemTypeFilterCtrl)("noEntriesFoundLabel",e.noDataFoundLabel),s(),h("ngForOf",j(14,15,e.filteredItemTypesArray[i])),s(3),h("multiple",!0),s(2),h("formControl",e.propertytMultiFilterCtrl),s(),h("ngForOf",j(20,17,e.filteredPropertyMultiArray[i])),s(2),b(e.statements.at(i).get("properties").hasError("differentDatatype")?21:-1),s(2),b(e.isWikibaseItemOnStatement===!0?23:-1),s(),b(e.isLiteralOnStatement===!0?24:-1),s(),b(e.isQualifier===!0?25:-1),s(),b(e.isAddQualifier?26:-1),s(),b(e.isRemoveStatement?27:-1),s(),b(e.isAddStatement?28:-1)}}var Dt=(()=>{let n=class n{constructor(){this.changeDetector=y(ke),this.request=y(J),this.setLanguage=y(qe),this.lang=y(A),this.propertyList=y(Ee),this.fb=y(Ve),this.searchEngine=y(Pt),this.data=y(be),this.controls=y(Wt),this.selectedItemType=new G,this.currentItemTypes=[],this.currentItemTypesArray=[],this.statementOptions=[],this.entityValues=[],this.currentMutator=fe,this.selectedLiteralVariables=[],this.isWikibaseItemOnStatement=!0,this.isLiteralOnStatement=!1,this.isLiteralStringOnStatement=!1,this.isWikibaseItemOnQualifier=!0,this.isLiteralOnQualifier=!1,this.isLiteralStringOnQualifier=!1,this.isLastStatement=!1,this.isAddStatement=!1,this.isRemoveStatement=!1,this.isAddQualifier=!1,this.isRemoveQualifier=!1,this.isQualifier=!1,this.isItemValue=!0,this.isLiteralVariableSelected=!0,this.selectedItemTypes=[],this.placeholderForLiteralValue="literal value?",this.placeholderForLiteralString="write string? | date? | number?",this.query=this.fb.group({statements:this.fb.array([this.statement])}),this.itemTypeFilterCtrl=new _(""),this.filteredItemTypesArray=[],this.propertytMultiFilterCtrl=new _(""),this.filteredPropertyMultiArray=[],this.itemValueFilterCtrl=new _(""),this.filteredItemValuesArray=[],this.literalFilterCtrl=new _(""),this.filteredLiteralVariables=new M(1),this.qualifierPropertyFilterCtrl=new _(""),this.filteredQualifierProperties=new M(1),this.qualifierValueFilterCtrl=new _(""),this.filteredQualifierValues=new M(1),this.qualifierLiteralFilterCtrl=new _(""),this.filteredQualifierLiteralVariables=new M(1),this.items=[],this.isQualifier2Display=!1,this.selectionChange=new G,this.propertySelectionChange=new G,this._onDestroy=new ee}set literalVariables(e){this._literalVariables=e,this.literalVariables&&this.filteredLiteralVariables.next(this.literalVariables.slice())}set qualifierLiteralVariables(e){this._qualifierLiteralVariables=e,this.qualifierLiteralVariables&&this.filteredQualifierLiteralVariables.next(this.qualifierLiteralVariables.slice())}get literalVariables(){return this._literalVariables}get qualifierLiteralVariables(){return this._qualifierLiteralVariables}get statements(){return this.query.get("statements")}qualifiers(e){return this.statements.at(e).get("qualifiers")}get lastStatementIndex(){let e=this.statements.length>0?this.statements.length-1:0;return console.log("lastStatementIndex:",e),e}get statement(){return this.fb.group({itemType:new _({value:"",disabled:!1}),properties:new _({value:[],disabled:!0},[pt.required,this.datatypeValidator]),value:this.value,optional:new _({value:!1,disabled:!1}),qualifiers:this.fb.array([this.qualifier])})}get value(){return this.fb.group({itemValue:new _({value:"",disabled:!0}),literalValue:new _({value:"",disabled:!0}),literalString:new _({value:"",disabled:!0})})}get qualifier(){return this.fb.group({qualifierProperty:new _({value:"",disabled:!1}),value:this.qualifierValue,optional:new _({value:!1,disabled:!1})})}get qualifierValue(){return this.fb.group({qualifierValue:new _({value:"",disabled:!0}),qualifierLiteralValue:new _({value:"",disabled:!0}),qualifierLiteralString:new _({value:"",disabled:!0})})}isPropertiesInvalid(e){return this.statements.at(e).get("properties").invalid}addStatements(){this.statements.push(this.statement),console.log("Added statement, new statements length:",this.statements.length),this.isRemoveStatement=!0,this.filteredItemTypesArray.push(new M(1)),this.filteredItemValuesArray.push(new M(1)),this.filteredPropertyMultiArray.push(new M(1)),this.statementOptions.push(new V([])),this.filteredItemTypesArray[this.lastStatementIndex].next([]),this.filteredItemValuesArray[this.lastStatementIndex].next([]),this.filteredPropertyMultiArray[this.lastStatementIndex].next([]),this.setCurrentItemTypes(this.lastStatementIndex),this.filterItemTypes(this.lastStatementIndex),this.filterItemValues(this.lastStatementIndex),this.filterPropertyMulti(this.lastStatementIndex,P([]))}removeStatements(e){this.statements.removeAt(e),console.log("Removed statement at index",e,"new statements length:",this.statements.length),this.currentItemTypesArray.splice(e,1),this.filteredItemTypesArray.splice(e,1),this.setCurrentItemTypes(this.lastStatementIndex),this.filterItemTypes(this.lastStatementIndex)}addQualifiers(e){let t=this.qualifiers(e).controls.length-1;this.qualifiers(e).pristine&&this.qualifiers(e).removeAt(t),this.isQualifier=!0,this.qualifiers(e).push(this.qualifier);let l=this.controls.qualifiers(this.statements,e);this.isQualifier=!0}addFirstQualifier(e){this.controls.qualifiers(this.statements,e).enable(),e===0&&(this.isQualifier=!0)}removeQualifiers(e,t){this.qualifiers(e).removeAt(t)}statementControllerDisplay(e,t){let l=this.statements.at(t),o=l.get("value.itemValue");e==="WikibaseItem"?(this.isWikibaseItemOnStatement=!0,this.isLiteralOnStatement=!1,o.enable(),l.get("value.literalValue").disable(),l.get("value.literalString").disable()):(e==="String"||e==="MonolingualText"||e==="Time"||e==="Quantity")&&(console.log(e),o.disable(),l.get("value.literalValue").enable(),l.get("value.literalString").enable(),this.isWikibaseItemOnStatement=!1,this.isLiteralStringOnStatement=!1,this.isLiteralOnStatement=!0)}literalControllerDisplay(e,t){e==="write literal string"||e==="write date : YYYY-MM-DD"||e==="write number"?(this.controls.literalValue(this.statements,t).enable(),this.controls.literalString(this.statements,t).enable(),this.controls.literalValue(this.statements,t).patchValue(""),this.isLiteralStringOnStatement=!0,this.placeholderForLiteralString="write below"):(this.controls.literalValue(this.statements,t).enable(),this.controls.literalString(this.statements,t).disable(),this.isLiteralStringOnStatement=!1,this.placeholderForLiteralString="disabled")}qualifierControllerDisplay(e,t,l){console.log(e);let o=this.controls.qualifiers(this.statements,t);if(e==="WikibaseItem"){let r=this.controls.qualifierValue(o,l);console.log(r),this.isWikibaseItemOnQualifier=!0,this.isLiteralOnQualifier=!1,this.controls.qualifierValue(o,l).enable(),this.controls.qualifierLiteralValue(o,l).disable(),this.controls.qualifierLiteralString(o,l).disable()}else(e==="String"||e==="MonolingualText"||e==="Time"||e==="Quantity")&&(this.controls.qualifierLiteralValue(o,l).enable(),this.controls.qualifierLiteralString(o,l).enable(),this.isWikibaseItemOnQualifier=!1,this.isLiteralOnQualifier=!0)}qualifierLiteralControllerDisplay(e,t,l){let o=this.controls.qualifiers(this.statements,t);e==="write literal string"||e==="write date : YYYY-MM-DD"||e==="write number"?(this.controls.qualifierLiteralValue(o,l).enable(),this.controls.qualifierLiteralString(o,l).enable(),this.isLiteralStringOnQualifier=!0):(this.controls.literalValue(o,l).enable(),this.controls.literalString(o,l).disable(),this.isLiteralStringOnQualifier=!1)}onItemTypeSelect(e){console.log(e.value),console.log("Selected itemType:",e.value);let t=e.value[0];this.controls.propertyValues(this.statements,t).enable();let l=this.propertyList.propertiesListBuilding(e.value[3]);this.filterPropertyMulti(t,l),this.selectedItemType.emit(e.value),this.statements.at(t).get("itemType").setValue(e.value,{emitEvent:!1}),console.log("Updated itemType control value:",this.statements.at(t).get("itemType").value),this.changeDetector.detectChanges()}onPropertySelect(e){let t=[];console.log("Event value:",e.value);let l=e.value[0][0];console.log(l);for(let o=0;o<e.value.length;o++)if(e.value[o]!==void 0){let r=e.value[o][3];console.log(r),r?(this.statementControllerDisplay(r,l),this.controls.itemValue(this.statements,l).enable()):console.error("Property type is undefined or invalid:",e.value[o][1].propertyType)}else console.error("Event value["+o+"] is undefined:",e.value)}onValueSelect(e){let t=e.value[0],l=e.value[1],o=e.value[2];console.log(e.value);let r=this.statements.at(t).get("value.itemValue");this.changeDetector.detectChanges(),l.charAt(0),this.isAddQualifier=!0,this.isAddStatement=!0,this.resetPreviousItemValues(t),console.log(this.resetPreviousItemValues(t))}onLiteralValueSelect(e){let t=e.value[0],l=e.value[1];this.placeholderForLiteralString=l,this.literalControllerDisplay(l,t),l.charAt(0)==="?"&&console.log(l),this.isAddStatement=!0,this.isAddQualifier=!0}onQualifierPropertySelect(e){console.log(e.value);let t=e.value[0],l=e.value[1],o=e.value[3];this.qualifierControllerDisplay(o,t,l)}onQualifierValueSelect(e){console.log(e.value);let t=e.value[0],l=e.value[1],o=e.value[2],r=e.value[3],u=e.value[4],g=[t,o,r,u];o.charAt(0),this.isRemoveQualifier=!0;let F=this.controls.qualifiers(this.statements,t),k=this.controls.qualifierValue(F,l);console.log(k),this.controls.patchQualifierValue(k,F,l)}onQualifierLiteralValueSelect(e){console.log(e.value);let t=e.value[0];e.value[2].charAt(0)==="?"?this.isLiteralStringOnQualifier=!1:this.isLiteralStringOnQualifier=!0,this.isRemoveQualifier=!0}clear(){this.matRef.options.forEach(e=>e.deselect())}ngOnInit(){console.log("Initial statements length:",this.statements.length),this.propertyList.qualifierPropertiesListBuilding.subscribe(e=>this.qualifierPropertiesToSelect=e),this.itemTypeFilterCtrl.valueChanges.pipe(w(this._onDestroy)).subscribe(()=>{this.filterItemTypes(this.lastStatementIndex)}),this.propertytMultiFilterCtrl.valueChanges.pipe(w(this._onDestroy)).subscribe(()=>{this.filterPropertyMulti(this.lastStatementIndex,P([]))}),this.itemValueFilterCtrl.valueChanges.pipe(w(this._onDestroy)).subscribe(()=>{this.filterItemValues(this.lastStatementIndex)}),this.literalFilterCtrl.valueChanges.pipe(w(this._onDestroy)).subscribe(()=>{this.filterLiteralVariables()}),this.qualifierPropertyFilterCtrl.valueChanges.pipe(w(this._onDestroy)).subscribe(()=>{this.filterQualifierProperties()}),this.qualifierValueFilterCtrl.valueChanges.pipe(w(this._onDestroy)).subscribe(()=>{this.filterQualifierValues()}),this.qualifierLiteralFilterCtrl.valueChanges.pipe(w(this._onDestroy)).subscribe(()=>{this.filterQualifierValues()}),this.statementOptions[0]=new V([]),this.filteredItemTypesArray.push(new M(1)),this.filteredItemValuesArray.push(new M(1)),this.filteredPropertyMultiArray.push(new M(1)),this.setCurrentItemTypes(this.lastStatementIndex),this.filterItemTypes(this.lastStatementIndex),this.filterItemValues(this.lastStatementIndex),this.filterPropertyMulti(this.lastStatementIndex,P([]))}ngAfterViewInit(){console.log("Statements length after view init:",this.statements.length),this.setInitialLiteralVariable(),this.setInitialQualifierPropertyValue(),this.setInitialQualifierValueValue(),this.setInitialQualifierLiteralVariable()}setInitialItemTypeValue(){this.data.itemTypes$.subscribe(e=>{this.filteredItemTypesArray.forEach((t,l)=>{console.log(e),t.next(e),this.filterItemTypes(l)})})}setInitialPropertyValue(){this.filteredPropertyMultiArray.forEach((e,t)=>{})}setInitialItemValue(){this.filteredItemValuesArray.forEach((e,t)=>{})}setInitialLiteralVariable(){this.filteredLiteralVariables}setInitialQualifierPropertyValue(){this.filteredQualifierProperties}setInitialQualifierValueValue(){this.filteredQualifierValues}setInitialQualifierLiteralVariable(){this.filterQualifierLiteralVariables}filterItemTypes(e){console.log("Calling setCurrentItemTypes with index:",e),this.setCurrentItemTypes(e),console.log("currentItemTypes after setCurrentItemTypes:",this.currentItemTypesArray[e]);let t=this.itemTypeFilterCtrl.value;t?(t=t.toLowerCase(),this.filteredItemTypesArray[e].next(this.currentItemTypesArray[e].filter(l=>l.label.toLowerCase().indexOf(t)>-1))):this.filteredItemTypesArray[e].next(this.currentItemTypesArray[e].slice()),this.changeDetector.detectChanges()}setCurrentItemTypes(e){if(console.log("setCurrentItemTypes called with index:",e),e===0)!O||O.length===0?(console.error("ITEMTYPES is undefined or empty"),this.currentItemTypesArray[e]=[]):(this.currentItemTypesArray[e]=O,console.log("Updated currentItemTypes:",this.currentItemTypesArray[e]));else{let t=[];for(let o=0;o<e;o++){let r=this.statements.at(o).get("itemType"),u=this.statements.at(o).get("value.itemValue");if(console.log("itemTypeControl at index",o,":",r),console.log("itemValueControl at index",o,":",u),r&&r.value){let g=r.value[1];console.log(`itemTypeControl value at index ${o}:`,g),t.push({label:g})}if(u&&u.value){let g=u.value[1];typeof g=="string"&&g.startsWith("?")&&t.push({label:g})}}let l=Array.from(new Set(t.map(o=>JSON.stringify(o)))).map(o=>JSON.parse(o));this.currentItemTypesArray[e]=l.sort((o,r)=>o.label.localeCompare(r.label)),console.log("Updated currentItemTypes:",this.currentItemTypesArray[e])}}filterPropertyMulti(e,t){t.pipe(q(l=>{if(!l||l.length===0)return console.error("Les donn\xE9es ne sont pas correctement charg\xE9es dans options."),P([]);console.log(l);let o=this.propertytMultiFilterCtrl.value;return o?(o=o.toLowerCase(),P(l.filter(r=>r.value.toLowerCase().indexOf(o)>-1))):P(l.slice())})).subscribe(l=>{this.filteredPropertyMultiArray[e].next(l)})}filterItemValues(e){let t=this.getSelectedOptionsUpToIndex(e),o=this.getLabelsFromSelectedOptions(t).map(r=>({label:r,col:null,id:null,separator:""}));console.log(o),this.statementOptions[e]||(this.statementOptions[e]=new V([])),this.statementOptions[e].next(o),this.filteredItemValuesArray[e]||(this.filteredItemValuesArray[e]=new M(1)),this.filteredItemValuesArray[e].next(o),this.resetPreviousItemValues(e)}resetPreviousItemValues(e){for(let t=0;t<e;t++){let l=this.statements.at(t).get("value.itemValue");l&&l.value&&l.setValue(l.value,{emitEvent:!1})}}getSelectedOptionsUpToIndex(e){let t=[],l=this.statements.at(e).get("itemType"),o=l?l.value[1]:null;for(let r=0;r<=e;r++){let u=this.statements.at(r).get("itemType"),g=this.statements.at(r).get("value.itemValue");if(u&&u.value){let F=[...u.value],k=F[1];if(g&&g.value){let Z=g.value[1].match(/^\?(.+?)(\d+)$/);if(Z){let _e=Z[1],De=parseInt(Z[2]),Ce=u.value[1].slice(0,-1);_e===Ce&&(k=_e+(De+1))}}let ye=k.charAt(k.length-1);if(/[a-zA-Z]$/.test(ye))k+="1";else if(/[0-9]$/.test(ye)){let We=parseInt(ye);k=k.slice(0,-1)+(We+1)}if(F[1]=k,r<e&&k===o)continue;if(r<e&&g&&g.value){let Z=g.value[1].match(/^\?(.+?)(\d+)$/);if(Z){let _e=Z[1],De=parseInt(Z[2]),Ce=_e+(De+1);t.some($t=>$t[1]===Ce)||t.push([u.value[0],Ce])}}t.push(F)}}return t}getLabelsFromSelectedOptions(e){return e.map(t=>t[1])}itemValuesList1(e){return this.data.mutator$.pipe(C(t=>t[0]))}itemValuesList2(e,t,l){let o=[];return this.request.searchItem(e,t).pipe(C(r=>this.createList(r)),q(r=>this.request.getItem(r)),$(r=>r!=null),$(r=>r.entities!==void 0&&r.entities!==null),C(r=>Object.values(r.entities)),C(r=>this.setLanguage.item(r,this.lang.selectedLang)))}filterLiteralVariables(){if(this.literalVariables===void 0)return;let e=this.literalFilterCtrl.value;if(e)e=e.toLowerCase();else{this.filteredLiteralVariables.next(this.literalVariables.slice());return}this.filteredLiteralVariables.next(this.literalVariables.filter(t=>t.label.toLowerCase().indexOf(e)>-1))}filterQualifierProperties(){if(!this.qualifierPropertiesToSelect)return;let e=this.qualifierPropertyFilterCtrl.value;if(e)e=e.toLowerCase();else{this.filteredQualifierProperties.next(this.qualifierPropertiesToSelect.slice());return}this.filteredQualifierProperties.next(this.qualifierPropertiesToSelect.filter(t=>t.itemLabel.label.toLowerCase().indexOf(e)>-1))}filterQualifierValues(){let e=this.qualifierValueFilterCtrl.value,t=e.charAt(0);if(e)t!=="?"?(e=e.toLowerCase(),this.qualifierValueFilterCtrl.valueChanges.pipe(te(400),q(l=>this.request.searchItem(l,this.lang.selectedLang)),C(l=>this.createList(l)),te(400),q(l=>this.request.getItem(l)),$(l=>l!=null),$(l=>l.entities!==void 0&&l.entities!==null),C(l=>Object.values(l.entities))).subscribe(l=>{this.entityValues=this.setLanguage.item(l,this.lang.selectedLang),this.setSeparator(this.entityValues),this.filteredQualifierValues.next(this.entityValues.filter(o=>o.label.toLowerCase().indexOf(e)>-1))})):this.data.mutator$.subscribe(l=>{this.entityValues=l[0];let o=[];o=this.entityValues.filter(r=>Et.includes(r.col)),e==="?*"?this.filteredQualifierValues.next(o):(e=e.slice(1),this.filteredQualifierValues.next(o.filter(r=>r.label.toLowerCase().indexOf(e)>-1)))});else{this.filteredQualifierValues.next(this.entityValues.slice());return}}filterQualifierLiteralVariables(){if(console.log(this.qualifierLiteralVariables),this.qualifierLiteralVariables===void 0)return;let e=this.qualifierLiteralFilterCtrl.value;if(console.log(e),e)e=e.toLowerCase();else{console.log(this.qualifierLiteralVariables),this.filteredQualifierLiteralVariables.next(this.qualifierLiteralVariables.slice());return}this.filteredQualifierLiteralVariables.next(this.qualifierLiteralVariables.filter(t=>t.label.toLowerCase().indexOf(e)>-1))}setSeparator(e){for(let t=0;t<e.length;t++)e[t].description&&(e[t].separator=", ")}selectedProperties(e){this.selectedPropertiesList=e.value}datatypeValidator(e){if(e.value&&e.value.length>1){let t=e.value[0][3];if(!e.value.every(o=>o[3]===t))return{differentDatatype:!0}}return null}notFound(e){return e=="https://database.factgrid.de//w/api.php?action=wbgetentities&ids=&format=json&origin=*"&&(e="https://database.factgrid.de//w/api.php?action=wbgetentities&ids=Q220375&format=json&origin=*"),e}createList(e){let t="https://database.factgrid.de//w/api.php?action=wbgetentities&ids=",l="&format=json&origin=*",o="",r="",u=e.search;u===void 0?u=[]:u=u;for(let g=0;g<u.length;g++)o=o+"|"+u[g].id;return o=o.slice(1),r=t+o+l,r}ngOnDestroy(){this._onDestroy.next(),this._onDestroy.complete()}};n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=B({type:n,selectors:[["app-statement-search"]],viewQuery:function(t,l){if(t&1&&(R(di,5),R(pi,7),R(mi,7)),t&2){let o;E(o=W())&&(l.matRef=o.first),E(o=W())&&(l.singleSelect=o.first),E(o=W())&&(l.multiSelect=o.first)}},inputs:{literalVariables:"literalVariables",qualifierLiteralVariables:"qualifierLiteralVariables"},outputs:{datatype:"datatype",selectedItemType:"selectedItemType",selectionChange:"selectionChange",propertySelectionChange:"propertySelectionChange"},decls:18,vars:5,consts:[["singleSelect",""],["appearance","outlined",1,"mat-elevation-z12"],[1,"listStyle"],["id","statements",1,"whiteBackGround"],[1,"search-center"],[3,"formGroup"],[1,"formPadding"],["formArrayName","statements"],[1,"statementStyle"],[1,"search-center3","cardGreyBackground",3,"formGroupName"],["formControlName","optional"],["appearance","fill"],["placeholder","subject?","formControlName","itemType","required","",3,"selectionChange"],["placeholderLabel","Search",3,"formControl","noEntriesFoundLabel"],[3,"value",4,"ngFor","ngForOf"],["placeholder","properties?","formControlName","properties","required","",3,"selectionChange","multiple"],["placeholderLabel","Search","noEntriesFoundLabel","Not found",3,"formControl"],[1,"validatorWarning"],["formGroupName","value",1,"search-center3"],[3,"value"],["placeholder","value?","formControlName","itemValue","required","",3,"selectionChange"],["formControlName","literalValue","required","",3,"selectionChange","placeholder"],["matInput","","formControlName","literalString",3,"placeholder"],["formArrayName","qualifiers"],["placeholder","property?","formControlName","qualifierProperty","required","",3,"selectionChange"],["placeholder","value?","formControlName","qualifierValue","required","",3,"selectionChange"],["placeholder","literal value?","formControlName","qualifierLiteralValue","required","",3,"selectionChange"],["matInput","","value","string?","formControlName","qualifierLiteralString"],["type","button",3,"click"]],template:function(t,l){t&1&&(d(0,"mat-card",1)(1,"mat-card-content")(2,"div",2)(3,"div"),m(4,"Query:"),c(),f(5,Li,2,0),c()(),d(6,"mat-card-content",3)(7,"p",4),m(8,"Statement:"),c(),d(9,"form",5)(10,"div",6)(11,"div",7),Y(12,Xi,29,19,null,null,ie),c()()(),d(14,"div")(15,"p",4),m(16),D(17,"json"),c()()()()),t&2&&(s(5),b(l.query.value.statements?5:-1),s(4),h("formGroup",l.query),s(3),H(l.statements.controls),s(4),x(" ",j(17,3,l.query.value)))},dependencies:[ae,Ie,le,ct,z,ut,Te,oe,mt,gt,ne,ht,yt,ft,bt,re,Fe,vt,ce,me,Le,Ae,se,K,de,he,ge,ue,It,Oe,pe,Mt],styles:[".validatorWarning[_ngcontent-%COMP%]{color:#ad1457;font-style:italic}mat-button-toggle-group[_ngcontent-%COMP%]{margin-left:12px}.search-center2[_ngcontent-%COMP%]{margin-top:20px;display:flex;justify-content:center}.search-center3[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column}#itemType[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:30vw}@media (max-width: 959.98px){#itemType[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:80vw}}#statements[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{width:60vw}#statements[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:30vw}@media (max-width: 959.98px){#statements[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:90vw}}.search-form[_ngcontent-%COMP%]{margin-top:20px;display:flex;justify-content:center;flex-direction:column}.ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:50px}.arrow-icon[_ngcontent-%COMP%]{display:flex;align-items:center;padding:0!important;justify-content:center}.icon-size[_ngcontent-%COMP%]{font-size:16px;height:16px;width:16px}.small-icon-button[_ngcontent-%COMP%]{width:24px!important;height:24px!important;padding:0!important;display:inline-flex!important;align-items:center;justify-content:center}.small-icon-button[_ngcontent-%COMP%] > *[role=img][_ngcontent-%COMP%]{width:16px;height:16px;font-size:16px}.small-icon-button[_ngcontent-%COMP%] > *[role=img][_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:16px;height:16px}.small-icon-button[_ngcontent-%COMP%]   .mat-mdc-button-touch-target[_ngcontent-%COMP%]{width:24px!important;height:24px!important}.search-center3[_ngcontent-%COMP%]{display:flex;justify-content:center}.list-search[_ngcontent-%COMP%]{display:flex;justify-content:left}.statement-search-form[_ngcontent-%COMP%]{margin-top:20px;gap:30px;display:flex;justify-content:center}.button-search-form[_ngcontent-%COMP%]{gap:30px;display:flex;justify-content:center}#projects[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:60vw}@media (max-width: 959.98px){#projects[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:90vw}}@media (max-width: 959.98px){.statement-search-form[_ngcontent-%COMP%]{margin-top:20px;display:flex;justify-content:center;flex-direction:column}}#sopi[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:60vw}@media (max-width: 959.98px){#sopi[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:90vw}}.button[_ngcontent-%COMP%]{text-align:start;background-color:transparent!important;border-color:transparent;font-size:12px}"]});let a=n;return a})();var jt=(()=>{let n=class n{constructor(){this.data=y(be)}mutator(e){console.log(e);let t=[];this.data.mutator$.subscribe(ye=>{t=ye});let l=this.transpose(t),o=e[1],r=e[3],u=e[2],g=l[u],F=this.circularPermutation(g);l[u]=F;let k=this.transpose(l);return console.log(k),k}transpose(e){return e[0].map((l,o)=>e.map(r=>r[o]))}circularPermutation(e){let t=[],l=e[0];for(let o=0;o<e.length-1;o++)t[o]=e[o+1];return t[5]=l,t}circularInversePermutation(e){let t=e[5];for(let l=0;l<e.length-1;l++)e[5-l]=e[5-(l+1)];return e[0]=t,e}};n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=L({token:n,factory:n.\u0275fac,providedIn:"root"});let a=n;return a})();var el=()=>[""],tl=()=>["/harmonia_universalis"],vo=(()=>{let n=class n{constructor(){this.lang=y(A),this.projectList=y(At),this.propertyList=y(Ee),this.data=y(be),this.mutator=y(jt),this.title="factgrid",this.subtitle="a database for historians",this.basic_search="search",this.projects="research projects",this.fields="fields of reserach",this.isDisplay=!1,this.selections=[],this.statementSelection=[],this.formData=[{statement:0,types:{options:O,selections:[]},values:{options:O,selections:[]}}],this.literals=qt,this.projectsList=[],this.propertiesList=[],this.replay=new M(1),this.lonos=[O.map(e=>e.order)]}ngOnInit(){this.subtitle=this.lang.getTranslation("$1",this.lang.selectedLang),this.projects=this.lang.getTranslation("$1",this.lang.selectedLang),this.fields=this.lang.getTranslation("$1",this.lang.selectedLang),this.projectList.projectsListBuilding("Q11295").subscribe(e=>this.projectsList=e)}selectedItemType(e){console.log(e);let t=e[0],l=O.findIndex(r=>r.id===e[3]),o={label:e[1],id:e[3]};console.log(e[3]),this.propertyList.propertiesListBuilding(e[3]).subscribe(r=>{console.log(r)})}propertyDatatype(e){return this.literalVariables=this.literals.filter(t=>(t.type===e[1]||t.type==="Any")&&t.col===e[0]),this.literalVariables}qualifierPropertyDatatype(e){return this.qualifierLiteralVariables=this.literals.filter(t=>(t.type===e[2]||t.type==="Any")&&t.col===e[0]),this.qualifierLiteralVariables}selectedProjects(e){console.log(e.value)}selectedValue(e){console.log(e),this.data.itemTypes1$.subscribe(F=>console.log(F));let t=e[0],l={variable:[e[0],this.updateValue(this.statementSelection[0].variable[2],e[2]),1],label:e[1],id:e[3]};this.statementSelection[1]?this.statementSelection.splice(1,1,l):this.statementSelection.push(l),this.selections.push(this.statementSelection);let o,r={label:e[1],col:e[2],id:e[3]},u=P(r);u.subscribe(F=>console.log(F)),Se([u,this.data.itemTypes1$]).subscribe(([F,k])=>{k.push(F),o=k}),this.data.updateItemTypes2(o);let g=this.mutator.mutator(e);this.data.updateMutatorForNextStatement(g)}selectedQualifierValue(e){let t=e[0],l=[e[1],e[2],e[3],""],o=this.mutator.mutator(l);console.log(o);let r={label:e[1],id:e[2],col:e[3]},u;this.data.itemTypes$.subscribe(g=>{u=g,t===0&&(u=[r])}),this.data.updateItemTypes(u),this.data.updateMutator(o),this.data.mutator$.subscribe(g=>console.log(g))}updateValue(e,t){let l;return(e=t)?l=t+1:l=t,l}findIndexById(e,t){return e.findIndex(l=>l.id===t)}incrementElement(e,t){if(e.length!==t.length)throw new Error("Les listes a et b doivent avoir la m\xEAme longueur");let l=[...t];for(let o=0;o<e.length;o++)if(e[o]===1){l[o]=t[o]+1;break}return l}ngOnDestroy(){}};n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=B({type:n,selectors:[["app-advanced-search"]],decls:26,vars:8,consts:[["href",it`https://fonts.googleapis.com/icon?family=Material+Icons`,"rel","stylesheet"],[1,"cardBackground"],[1,"FactGridTitle"],[1,"subTitle"],["appearance","outlined",1,"mat-elevation-z12"],[1,"search-container"],[1,"search-center"],[3,"routerLink"],["href","https://database.factgrid.de/query/#%23model%0A%0ASELECT%20%3Fitem%20%3Fviewer%20%3FitemLabel%20%20WHERE%20%7B%0A%20%20SERVICE%20wikibase%3Alabel%20%7B%20bd%3AserviceParam%20wikibase%3Alanguage%20%22%5BAUTO_LANGUAGE%5D%2Cen%22.%20%7D%0A%20%20%3Fitem%20wdt%3AP2%20wd%3AQ7%3B%0A%20%20%20%20%20%20%20%20wdt%3AP247%20wd%3AQ24708.%0A%20%20BIND%28STRAFTER%28STR%28%3Fitem%29%2C%20STR%28wd%3A%29%29%20AS%20%3FitemId%29%0A%20%20BIND%28IRI%28CONCAT%28%22https%3A%2F%2Fdatabase.factgrid.de%2Fviewer%2Fitem%2F%22%2C%20%3FitemId%29%29%20AS%20%3Fviewer%29%0A%7D%0A"],["color","primary"],[3,"selectionChange","data"],[1,"child-container",3,"propertyDatatype","selectedQualifierValue","qualifierPropertyDatatype","selectedValue","selectedItemType","qualifierLiteralVariables","literalVariables"]],template:function(t,l){t&1&&(d(0,"head"),I(1,"link",0),c(),d(2,"body")(3,"div",1)(4,"div",2),m(5,"FactGrid"),c(),d(6,"div",3),m(7),c()(),d(8,"mat-card",4)(9,"mat-card-content",5)(10,"div",6)(11,"a",7),m(12,"FactGrid"),c(),d(13,"span"),m(14,"\xA0\xA0|\xA0\xA0"),c(),d(15,"a",8),m(16," sparql query "),c(),d(17,"span"),m(18,"\xA0\xA0|\xA0\xA0"),c(),d(19,"a",7),m(20,"Harmonia Universalis"),c()(),d(21,"div",6)(22,"mat-icon",9),m(23,"build"),c()(),d(24,"app-project-select",10),S("selectionChange",function(r){return l.selectedProjects(r)}),c(),d(25,"app-statement-search",11),S("propertyDatatype",function(r){return l.propertyDatatype(r)})("selectedQualifierValue",function(r){return l.selectedQualifierValue(r)})("qualifierPropertyDatatype",function(r){return l.qualifierPropertyDatatype(r)})("selectedValue",function(r){return l.selectedValue(r)})("selectedItemType",function(r){return l.selectedItemType(r)}),c()()()()),t&2&&(s(7),ve(l.subtitle),s(4),h("routerLink",Ye(6,el)),s(8),h("routerLink",Ye(7,tl)),s(5),h("data",l.projectsList),s(),h("qualifierLiteralVariables",l.qualifierLiteralVariables)("literalVariables",l.literalVariables))},dependencies:[ae,Ct,_t,z,re,Fe,de,kt,se,Me,K,me,Le,Ae,Pe,he,Ot,Dt],styles:[".child-container[_ngcontent-%COMP%]{width:70vw;justify-content:center;align-items:center;display:flex}.search-align[_ngcontent-%COMP%]{display:flex;flex-direction:row}.search-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.search-label[_ngcontent-%COMP%]{font-weight:700}.FactGrid-div[_ngcontent-%COMP%]{height:150px;display:flex;align-items:center;justify-content:center}.FactGridTitle-div[_ngcontent-%COMP%]{padding-left:10px;color:#ad1457;font-weight:600;font-size:60px}.search-itemSelected[_ngcontent-%COMP%]{margin-top:50px}#projects[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:60vw}@media (max-width: 959.98px){#projects[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:90vw}}.selectedItemSize[_ngcontent-%COMP%]{font-size:14px}.button[_ngcontent-%COMP%]{background-color:transparent!important;border-color:transparent;font-size:16px}a.button[_ngcontent-%COMP%]:hover{background:#383}"]});let a=n;return a})();export{vo as AdvancedSearchComponent};
